修繕登記簿2000-2軟件說明(ASP版本)
===========================================================

一、版權聲明：
  1.提供各位無償使用，無須給付任何費用。
  2.懇請保留本校著作權聲明字串。
  3.可自行修改，無須經過本校同意。
  4.本校聲明放棄因本軟件運作所衍生除教育
    用途外之各項利益。

二、安裝提醒事項：
  1.可以配合附贈的pwd目錄來做密碼控管。
  2.權限設定建議：
    (1)目錄：「讀取」、「執行」、「寫入」
    (2)asp檔案：「讀取」、「執行」
    (3)mdb檔案：「讀取」、「寫入」
    上述權限請開給「IUSR」。
  3.本版本具備電子郵件回覆功能，請記得：
    (1)把form.asp的程式中，有本校相關資訊
       的部分改為貴校的，其為：第49行
    (2)把sentout.asp的程式中，有本校相關資訊
       的部分改為貴校的，分別為：
       第89行、第116行、第120行、第121行、第122行
    (3)把replydetail.asp的程式中，有本校相關資訊
       的部分改為貴校的，其為：第64行 <-- 感謝kimi來函指導
    如果您的電子郵件回覆還是出了問題，
    請檢查您是否安裝了SMTP服務，
    如果您要改用JMail也無妨，
    只是要請您自行套用一下JMail的物件。

三、如果您正在使用本校的board2000或是gbook2000：
  1.這裡所使用的 pwd的資料庫，建議您稍微
    看一下這裡：
    (1)「事務組長」和「資訊小組」因為等級
       都是「z」，所以都可以回覆修繕記錄
       簿。
    (2)只要是回覆修繕記錄簿的行政人員都可
       以刪除自己之前張貼過的回應；只不過
       只能刪除自己張貼的，不能刪除別的行
       政人員貼的。
    (3)「系統管理者」多了一個「leader」的
       等級，這使得系統管理者可以刪除全部
       的修繕記錄，其中包括了申請修繕的文
       章和所有回覆的文章。
       這個權限很大，建議不要隨便開給任何
       人。
  2.我之所以還是附上pwd的全部檔案的原因，
    是因為pwd.asp這個檔案又稍作修改了，請
    您記得更新這個檔案。

四、修正
  2000/04/21
    (1)reply.asp
       修正回應修繕申請的權限認證

五、預防不肖的系統管理者：
  1.各位略懂 ASP的網友們都知道，ASP本身最
    嚴重的問題除了透過IIS的漏洞可以看到原
    始碼外(這個漏洞到了 SP6還是沒有解決；
    我指的不是「DATA」參數這種老漏洞)，就
    是像是我們這種公布原始程式碼的笨蛋學校
    可能會造成對您網站的新危機。
    因為我們這種笨蛋學校只是基於教育資源共
    享的原則 release程式碼，卻直到現在才想
    起要提醒您做一點點的修改，就可以稍微提
    升一些安全性。
  2.如何稍微提升一點點的安全性：
    (1)第一階段，您應該盡量去瞭解網址上、
       Get參數的運作過程，先將程式之間傳遞
       參數流程稍作瞭解，然後把這些參數傳
       遞用的代數全盤改變一下，以防不肖人
       士利用Get的代數來直接對程式下指令。
       (這一點，台北市逸仙國小就改得很好)
    (2)第二階段，能夠用Post方式取代Get方式
       的，就盡量修改一下，只是要用到表單
       物件也許有點不習慣，但是只要善用表
       單物件的<Form name="">，來進行參數
       方式的表單命名，一樣可以在一個網頁
       中，同時存在無數個迴圈所產生、不同
       表單名稱的表單物件。
       當然，Post方式也有漏洞，只是沒有Get
       那麼明顯罷了。
       我建議，系統管理層級最高、影響最嚴重
       的參數，還是用Get的方式，畢竟用Get方
       式來破解，基本上還是要先知道下一個程
       式要request什麼變數，這一點還是比較
       安全。
       不過如果貴單位系統管理者異位的時候，
       新的管理者要記得稍改一下代數，因為
       Get代數不是曾經被前任管理者都摸透了
       嗎？
    (3)第三階段，資料庫的pTag的參數偶爾要跟
       程式裡面的驗證參數要同步變更一下，不
       要老是一成不變。
       我們學校的管理階層如果是用「z」，那
       您的管理階層最好不要跟我們一樣用「z」
       來作等級識別，否則難保有一天我寫程式
       發了瘋，到處Get您的管理程式。
    (4)第四階段，建立兩個虛擬目錄，分別放置
       script和database，然後這兩個目錄裡面
       再去各自發展次目錄；也就是「程式和資
       料庫不要放在同一個目錄」。
       分建兩個目錄的好處是：
       A.兩個目錄對於IUSR的權限各有不同，資
         料庫目錄的權限一次就可以統一設定；
         而程式目錄的執行權限也是一次就可以
         搞定，不用在每一個每一個目錄去設定
         權限，反正所有在 script 目錄底下的
         script，都是同一種權限；反之，資料
         庫亦然。
       B.如果不這樣做，資料庫很容易就被透過
         HTTP的方式整個檔案下載到客戶端。
         當然，如果是公佈欄的資料庫也就算了
         ，反正不肖人士修改完畢、也不太容易
         任意地上載到虛擬目錄裡；就算可以，
         公佈欄被寫了幾句 4-words也可以及時
         刪除；但是公佈欄的資料庫欄位名稱外
         露總是不好。
         更甚者，如果是密碼的資料庫被下載了
         呢？也許您可以先用Access預設密碼方
         式、就算他下載了，用Access還是打不
         開，但是連Word的密碼都有人解了，難
         保Access的資料庫亦然。
       ...... ......
       ...... ......
       不知道我的淺見是在幫您、
       還是在教育可愛的hackers，
       我相信真正的cracker功力比您我都高得多，
       我這樣做只是最粗淺防範，
       想到再聊吧！？

五、後續交流：
  1.安裝過程如有疑問，歡迎光臨本校「資訊
    網路中心」之「技術討論區」投書。
  2.如果您修改過本軟件，甚至只是版面配色
    ，都歡迎您透過falcon@wfes.tp.edu.tw
    將軟件上載，我們將會提供他校下載參考
    使用，以達到資源共享之原則。
  3.如果您已經有了舊有的留言版內容，在資
    料庫欄位可以包容的情況之下，我們可以
    幫您轉換。
  4.本校官方網站上的，是另一個新的版本，
    可以在張貼公告的時候，同時上傳檔案作
    為「附件」，當訪客在瀏覽的時候，可以
    直接從網站上下載附件。

    範例位於：
    本校官方網站「資訊網路中心」、「修繕
    登記簿」。

===========================================================
台北市文山區萬芳國民小學
   11602台北市文山區萬和街一號
   +886-2-2230-1232
   +886-2-2230-2582
   +886-2-2230-3855
   +886-2-2230-9032
   +886-2-2230-1009(FAX)
http://www.wfes.tp.edu.tw(Official Web Site)
http://w3.wfes.tp.edu.tw(Information Center)
http://bbs.wfes.tp.edu.tw(WWW)
http://bbs.wfes.tp.edu.tw:2000(Telnet)

小學部資訊小組硬體部兼程式部
Falcon Vader
謹識
Apr.21.2000